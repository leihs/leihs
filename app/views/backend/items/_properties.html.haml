:ruby
  # type: default "text"
  properties_tree = {"Umzug" => {
                                 :umzug => { :type => "select", :label => _("Umzug"), :values => ["zÃ¼geln", "sofort entsorgen", "bei Umzug entsorgen", "bei Umzug verkaufen"]},
                                 :zielraum => { :label => _("Zielraum")}
                     },
                     "Toni Ankunftskontrolle" => {
                                 :ankunftsdatum => { :type => "date", :label => _("Ankunftsdatum")},
                                 :ankunftszustand => { :type => "select", :label => _("Ankunftszustand"), :values => ["intakt", "transportschaden"]},
                                 :ankunftsnotiz => { :type => "textarea", :label => _("Ankunftsnotiz")}
                     } }
                  

- properties_tree.each_pair do |title, property_keys|

  %section
    %h2= title

    .inner
      - property_keys.each_pair do |k,v|
        .field
          %h3.key= v[:label]
          .value
            - case v[:type]
              - when "select"
                %select{:name => "item[properties][#{k}]"}
                  - v[:values].each do |value|
                    %option{:value => value, :selected => (value == @item.properties[k] ? "selected" : nil)}= value
              - when "date"
                %input{:type => :hidden, :name => "item[properties][#{k}]", :value => @item.properties[k]}          
                %input.datepicker{:type => "text"}
              - when "textarea"
                %textarea{:name => "item[properties][#{k}]"}= @item.properties[k]
              - else
                %input{:type => "text", :name => "item[properties][#{k}]", :value => @item.properties[k]}