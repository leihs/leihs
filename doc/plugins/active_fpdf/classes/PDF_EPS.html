<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Module: PDF_EPS</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href=".././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Module</strong></td>
          <td class="class-name-in-header">PDF_EPS</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../files/vendor/plugins/active_fpdf/lib/fpdf_eps_rb.html">
                vendor/plugins/active_fpdf/lib/fpdf_eps.rb
                </a>
        <br />
            </td>
        </tr>

        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <p>
Information
</p>
<p>
<a href="PDF_EPS.html">PDF_EPS</a> class from Valentin Schmidt ported to
ruby by Thiago Jackiw (tjackiw@gmail.com) working for Mingle LLC (<a
href="http://www.mingle.com">www.mingle.com</a>) Release Date: July 13th,
2006
</p>
<p>
Description
</p>
<p>
This script allows to embed vector-based Adobe Illustrator (AI) or
AI-compatible EPS files. Only vector drawing is supported, not text or
bitmap. Although the script was successfully tested with various AI format
versions, best results are probably achieved with files that were exported
in the AI3 format (tested with Illustrator CS2, Freehand MX and Photoshop
CS2).
</p>
<p>
<a href="PDF_EPS.html#M000095">ImageEps</a>(string file, float x, float y
[, float w [, float h [, string link [, boolean useBoundingBox]]]])
</p>
<p>
Same parameters as for regular FPDF::Image() method, with an additional
one:
</p>
<p>
useBoundingBox: specifies whether to position the bounding box (true) or
the complete canvas (false) at location (x,y). Default value is true.
</p>
<p>
First added to the Ruby <a href="FPDF.html">FPDF</a> distribution in 1.53c
</p>
<p>
Usage is as follows:
</p>
<p>
require &#8216;fpdf&#8217; require &#8216;fpdf_eps&#8217; pdf = <a
href="FPDF.html#M000009">FPDF.new</a> pdf.extend(PDF_EPS) pdf.ImageEps(...)
</p>
<p>
This allows it to be combined with other extensions, such as the bookmark
module.
</p>

    </div>


   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000095">ImageEps</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->

    <div id="section">





      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000095" class="method-detail">
        <a name="M000095"></a>

        <div class="method-heading">
          <a href="#M000095" class="method-signature">
          <span class="method-name">ImageEps</span><span class="method-args">(file, x, y, w=0, h=0, link='', use_bounding_box=true)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000095-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000095-source">
<pre>
     <span class="ruby-comment cmt"># File vendor/plugins/active_fpdf/lib/fpdf_eps.rb, line 35</span>
 35:     <span class="ruby-keyword kw">def</span> <span class="ruby-constant">ImageEps</span>(<span class="ruby-identifier">file</span>, <span class="ruby-identifier">x</span>, <span class="ruby-identifier">y</span>, <span class="ruby-identifier">w</span>=<span class="ruby-value">0</span>, <span class="ruby-identifier">h</span>=<span class="ruby-value">0</span>, <span class="ruby-identifier">link</span>=<span class="ruby-value str">''</span>, <span class="ruby-identifier">use_bounding_box</span>=<span class="ruby-keyword kw">true</span>)
 36:         <span class="ruby-identifier">data</span> = <span class="ruby-keyword kw">nil</span>
 37:         <span class="ruby-keyword kw">if</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exists?</span>(<span class="ruby-identifier">file</span>)
 38:             <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">file</span>, <span class="ruby-value str">'rb'</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span>
 39:                 <span class="ruby-identifier">data</span> = <span class="ruby-identifier">f</span>.<span class="ruby-identifier">read</span>()
 40:             <span class="ruby-keyword kw">end</span>
 41:         <span class="ruby-keyword kw">else</span>
 42:             <span class="ruby-constant">Error</span>(<span class="ruby-value str">'EPS file not found: '</span><span class="ruby-operator">+</span><span class="ruby-identifier">file</span>)
 43:         <span class="ruby-keyword kw">end</span>
 44:         
 45:         <span class="ruby-comment cmt"># Find BoundingBox param</span>
 46:         <span class="ruby-identifier">regs</span> = <span class="ruby-identifier">data</span>.<span class="ruby-identifier">scan</span>(<span class="ruby-regexp re">/%%BoundingBox: [^\r\n]*/</span><span class="ruby-identifier">m</span>)
 47:         <span class="ruby-identifier">regs</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">regs</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/%%BoundingBox: /</span>, <span class="ruby-value str">''</span>)
 48:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">regs</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>
 49:             <span class="ruby-identifier">tmp</span> = <span class="ruby-identifier">regs</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">' '</span>)
 50:             <span class="ruby-ivar">@x1</span> = <span class="ruby-identifier">tmp</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">to_i</span>
 51:             <span class="ruby-ivar">@y1</span> = <span class="ruby-identifier">tmp</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">to_i</span>
 52:             <span class="ruby-ivar">@x2</span> = <span class="ruby-identifier">tmp</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">to_i</span>
 53:             <span class="ruby-ivar">@y2</span> = <span class="ruby-identifier">tmp</span>[<span class="ruby-value">3</span>].<span class="ruby-identifier">to_i</span>
 54:         <span class="ruby-keyword kw">else</span>
 55:             <span class="ruby-constant">Error</span>(<span class="ruby-value str">'No BoundingBox found in EPS file: '</span><span class="ruby-operator">+</span><span class="ruby-identifier">file</span>)
 56:         <span class="ruby-keyword kw">end</span>
 57:         <span class="ruby-identifier">f_start</span> = <span class="ruby-identifier">data</span>.<span class="ruby-identifier">index</span>(<span class="ruby-value str">'%%EndSetup'</span>)
 58:         <span class="ruby-identifier">f_start</span> = <span class="ruby-identifier">data</span>.<span class="ruby-identifier">index</span>(<span class="ruby-value str">'%%EndProlog'</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">f_start</span> <span class="ruby-operator">===</span> <span class="ruby-keyword kw">false</span>
 59:         <span class="ruby-identifier">f_start</span> = <span class="ruby-identifier">data</span>.<span class="ruby-identifier">index</span>(<span class="ruby-value str">'%%BoundingBox'</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">f_start</span> <span class="ruby-operator">===</span> <span class="ruby-keyword kw">false</span>
 60:         
 61:         <span class="ruby-identifier">data</span> = <span class="ruby-identifier">data</span>.<span class="ruby-identifier">slice</span>(<span class="ruby-identifier">f_start</span>, <span class="ruby-identifier">data</span>.<span class="ruby-identifier">length</span>)
 62:         
 63:         <span class="ruby-identifier">f_end</span> = <span class="ruby-identifier">data</span>.<span class="ruby-identifier">index</span>(<span class="ruby-value str">'%%PageTrailer'</span>)
 64:         <span class="ruby-identifier">f_end</span> = <span class="ruby-identifier">data</span>.<span class="ruby-identifier">index</span>(<span class="ruby-value str">'showpage'</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">f_end</span> <span class="ruby-operator">===</span> <span class="ruby-keyword kw">false</span>
 65:         <span class="ruby-identifier">data</span> = <span class="ruby-identifier">data</span>.<span class="ruby-identifier">slice</span>(<span class="ruby-value">0</span>, <span class="ruby-identifier">f_end</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">f_end</span>
 66:         
 67:         <span class="ruby-comment cmt"># save the current graphic state</span>
 68:         <span class="ruby-identifier">out</span>(<span class="ruby-value str">'q'</span>)
 69:         
 70:         <span class="ruby-identifier">k</span> = <span class="ruby-ivar">@k</span>
 71:         
 72:         <span class="ruby-comment cmt"># Translate</span>
 73:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">use_bounding_box</span>
 74:             <span class="ruby-identifier">dx</span> = <span class="ruby-identifier">x</span><span class="ruby-operator">*</span><span class="ruby-identifier">k</span><span class="ruby-operator">-</span><span class="ruby-ivar">@x1</span>
 75:             <span class="ruby-identifier">dy</span> = <span class="ruby-ivar">@hPt</span><span class="ruby-operator">-</span><span class="ruby-ivar">@y2</span><span class="ruby-operator">-</span><span class="ruby-identifier">y</span><span class="ruby-operator">*</span><span class="ruby-identifier">k</span>
 76:         <span class="ruby-keyword kw">else</span>
 77:             <span class="ruby-identifier">dx</span> = <span class="ruby-identifier">x</span><span class="ruby-operator">*</span><span class="ruby-identifier">k</span>
 78:             <span class="ruby-identifier">dy</span> = <span class="ruby-operator">-</span><span class="ruby-identifier">y</span><span class="ruby-operator">*</span><span class="ruby-identifier">k</span>
 79:         <span class="ruby-keyword kw">end</span>
 80:         <span class="ruby-identifier">tm</span> = [<span class="ruby-value">1</span>,<span class="ruby-value">0</span>,<span class="ruby-value">0</span>,<span class="ruby-value">1</span>,<span class="ruby-identifier">dx</span>,<span class="ruby-identifier">dy</span>]
 81:         <span class="ruby-identifier">out</span>(<span class="ruby-identifier">sprintf</span>(<span class="ruby-value str">'%.3f %.3f %.3f %.3f %.3f %.3f cm'</span>,
 82:             <span class="ruby-identifier">tm</span>[<span class="ruby-value">0</span>], <span class="ruby-identifier">tm</span>[<span class="ruby-value">1</span>], <span class="ruby-identifier">tm</span>[<span class="ruby-value">2</span>], <span class="ruby-identifier">tm</span>[<span class="ruby-value">3</span>], <span class="ruby-identifier">tm</span>[<span class="ruby-value">4</span>], <span class="ruby-identifier">tm</span>[<span class="ruby-value">5</span>]))
 83:         
 84:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">w</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>
 85:             <span class="ruby-identifier">scale_x</span> = <span class="ruby-identifier">w</span><span class="ruby-operator">/</span>((<span class="ruby-ivar">@x2</span><span class="ruby-operator">-</span><span class="ruby-ivar">@x1</span>)<span class="ruby-operator">/</span><span class="ruby-identifier">k</span>)
 86:             <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">h</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>
 87:                 <span class="ruby-identifier">scale_y</span> = <span class="ruby-identifier">h</span><span class="ruby-operator">/</span>((<span class="ruby-ivar">@y2</span><span class="ruby-operator">-</span><span class="ruby-ivar">@y1</span>)<span class="ruby-operator">/</span><span class="ruby-identifier">k</span>)
 88:             <span class="ruby-keyword kw">else</span>
 89:                 <span class="ruby-identifier">scale_y</span> = <span class="ruby-identifier">scale_x</span>
 90:                 <span class="ruby-identifier">h</span> = (<span class="ruby-ivar">@y2</span><span class="ruby-operator">-</span><span class="ruby-ivar">@y1</span>)<span class="ruby-operator">/</span><span class="ruby-identifier">k</span> <span class="ruby-operator">*</span> <span class="ruby-identifier">scale_y</span>
 91:             <span class="ruby-keyword kw">end</span>
 92:         <span class="ruby-keyword kw">else</span>
 93:             <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">h</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>
 94:                 <span class="ruby-identifier">scale_y</span> = <span class="ruby-identifier">$h</span><span class="ruby-operator">/</span>((<span class="ruby-ivar">@y2</span><span class="ruby-operator">-</span><span class="ruby-ivar">@y1</span>)<span class="ruby-operator">/</span><span class="ruby-identifier">$k</span>)
 95:                 <span class="ruby-identifier">scale_x</span> = <span class="ruby-identifier">scale_y</span>
 96:                 <span class="ruby-identifier">w</span> = (<span class="ruby-ivar">@x2</span><span class="ruby-operator">-</span><span class="ruby-ivar">@x1</span>)<span class="ruby-operator">/</span><span class="ruby-identifier">k</span> <span class="ruby-operator">*</span> <span class="ruby-identifier">scale_x</span>
 97:             <span class="ruby-keyword kw">else</span>
 98:                 <span class="ruby-identifier">w</span> = (<span class="ruby-ivar">@x2</span><span class="ruby-operator">-</span><span class="ruby-ivar">@x1</span>)<span class="ruby-operator">/</span><span class="ruby-identifier">k</span>
 99:                 <span class="ruby-identifier">h</span> = (<span class="ruby-ivar">@y2</span><span class="ruby-operator">-</span><span class="ruby-ivar">@y1</span>)<span class="ruby-operator">/</span><span class="ruby-identifier">k</span>
100:             <span class="ruby-keyword kw">end</span>
101:         <span class="ruby-keyword kw">end</span>
102:         
103:         <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">scale_x</span>.<span class="ruby-identifier">nil?</span>
104:             <span class="ruby-comment cmt"># Scale</span>
105:             <span class="ruby-identifier">tm</span> = [<span class="ruby-identifier">scale_x</span>,<span class="ruby-value">0</span>,<span class="ruby-value">0</span>,<span class="ruby-identifier">scale_y</span>,<span class="ruby-value">0</span>,<span class="ruby-ivar">@hPt</span><span class="ruby-operator">*</span>(<span class="ruby-value">1</span><span class="ruby-operator">-</span><span class="ruby-identifier">scale_y</span>)]
106:             <span class="ruby-identifier">out</span>(<span class="ruby-identifier">sprintf</span>(<span class="ruby-value str">'%.3f %.3f %.3f %.3f %.3f %.3f cm'</span>,
107:                 <span class="ruby-identifier">tm</span>[<span class="ruby-value">0</span>], <span class="ruby-identifier">tm</span>[<span class="ruby-value">1</span>], <span class="ruby-identifier">tm</span>[<span class="ruby-value">2</span>], <span class="ruby-identifier">tm</span>[<span class="ruby-value">3</span>], <span class="ruby-identifier">tm</span>[<span class="ruby-value">4</span>], <span class="ruby-identifier">tm</span>[<span class="ruby-value">5</span>]))
108:         <span class="ruby-keyword kw">end</span>
109:         
110:         <span class="ruby-identifier">data</span>.<span class="ruby-identifier">split</span>(<span class="ruby-regexp re">/\r\n|[\r\n]/</span>).<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">line</span><span class="ruby-operator">|</span>
111:             <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">line</span> <span class="ruby-operator">==</span> <span class="ruby-value str">''</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">line</span>[<span class="ruby-value">0</span>,<span class="ruby-value">1</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">'%'</span>
112:             <span class="ruby-identifier">len</span> = <span class="ruby-identifier">line</span>.<span class="ruby-identifier">length</span>
113:             <span class="ruby-comment cmt"># next if (len &gt; 2 &amp;&amp; line[len-2,len] != ' ')</span>
114:             <span class="ruby-identifier">cmd</span> = <span class="ruby-identifier">line</span>[<span class="ruby-identifier">len</span><span class="ruby-operator">-</span><span class="ruby-value">2</span>,<span class="ruby-identifier">len</span>].<span class="ruby-identifier">strip</span>
115:             <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">cmd</span>
116:                 <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'m'</span>, <span class="ruby-value str">'l'</span>, <span class="ruby-value str">'v'</span>, <span class="ruby-value str">'y'</span>, <span class="ruby-value str">'c'</span>, <span class="ruby-value str">'k'</span>, <span class="ruby-value str">'K'</span>, <span class="ruby-value str">'g'</span>, <span class="ruby-value str">'G'</span>, <span class="ruby-value str">'s'</span>, <span class="ruby-value str">'S'</span>, <span class="ruby-value str">'J'</span>, <span class="ruby-value str">'j'</span>, <span class="ruby-value str">'w'</span>, <span class="ruby-value str">'M'</span>, <span class="ruby-value str">'d'</span><span class="ruby-operator">:</span>
117:                     <span class="ruby-identifier">out</span>(<span class="ruby-identifier">line</span>)
118:                 
119:                 <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'L'</span><span class="ruby-operator">:</span>
120:                     <span class="ruby-identifier">line</span>[<span class="ruby-identifier">len</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>,<span class="ruby-identifier">len</span>]=<span class="ruby-value str">'l'</span>
121:                     <span class="ruby-identifier">out</span>(<span class="ruby-identifier">line</span>)
122:                 
123:                 <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'C'</span><span class="ruby-operator">:</span>
124:                     <span class="ruby-identifier">line</span>[<span class="ruby-identifier">len</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>,<span class="ruby-identifier">len</span>]=<span class="ruby-value str">'c'</span>
125:                     <span class="ruby-identifier">out</span>(<span class="ruby-identifier">line</span>)
126:                 
127:                 <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'f'</span>, <span class="ruby-value str">'F'</span><span class="ruby-operator">:</span>
128:                     <span class="ruby-identifier">out</span>(<span class="ruby-value str">'f*'</span>)
129:                 
130:                 <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'b'</span>, <span class="ruby-value str">'B'</span><span class="ruby-operator">:</span>
131:                     <span class="ruby-identifier">out</span>(<span class="ruby-identifier">cmd</span> <span class="ruby-operator">+</span> <span class="ruby-value str">'*'</span>)
132:             <span class="ruby-keyword kw">end</span>
133:         <span class="ruby-keyword kw">end</span>
134:         
135:         <span class="ruby-comment cmt"># restore previous graphic state</span>
136:         <span class="ruby-identifier">out</span>(<span class="ruby-value str">'Q'</span>)
137:         <span class="ruby-constant">Link</span>(<span class="ruby-identifier">x</span>,<span class="ruby-identifier">y</span>,<span class="ruby-identifier">w</span>,<span class="ruby-identifier">h</span>,<span class="ruby-identifier">link</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">link</span>
138:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>